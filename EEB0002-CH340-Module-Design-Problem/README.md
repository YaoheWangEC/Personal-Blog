# CH340模块设计问题
2024.07.12 22:43

今天在使用自己设计的CH340模块烧录STC8H的时候发现了一个问题：使用上电复位进行烧录时，负载端过大的库电容会直接拉低CH340的供电导致意外断连。具体而言，我的模块上CH340供电和单片机共用一个3.3V电源，烧录模块端的电容只有4.7uF,但是单片机端的库电容有22uF,两者均为MLCC,上电瞬间win10发出声音警告CH340断连。

经过多次测试，确认是电容问题，在烧录模块端加焊一颗220uF的电解电容稍微缓解了这个问题(出问题的概率从100%到80%),幸好STC-ISP可以将P54改回成复位脚，我也预留了外部复位电路，配置好后只要拉低复位脚就行了。

![](ch340-module.jpg)

这个问题有以下解决办法：
1. 烧录器端CH340和供电分离，用两个电源供电，只要烧录器的库电容足够大就没不会产生上述问题
2. 共用电源的情况下可以增大电源的主滤波电容，降低ESR，防止被一下子拉低
3. 供电端串接个小电阻限流